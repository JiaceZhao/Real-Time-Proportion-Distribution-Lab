# 📊 数据管理和Excel导出功能

## 🎯 新增功能概览

您的比例分布实验室现在包含了强大的数据管理和Excel导出功能！

### ✨ 主要特性

#### 📝 数据持久化存储
- **自动保存**: 当前会话数据自动保存到浏览器本地存储
- **会话管理**: 可以保存多个独立的数据收集会话
- **历史记录**: 查看所有历史会话的统计摘要
- **会话恢复**: 刷新页面后自动恢复当前未保存的数据

#### 📊 Excel数据导出
1. **导出当前数据** 📈
   - 包含所有当前输入的比例值
   - 自动计算统计摘要（平均值、中位数、标准差等）
   - 生成两个工作表：原始数据 + 统计摘要

2. **导出所有会话** 📋
   - 每个保存的会话创建独立工作表
   - 包含总体统计摘要
   - 完整的历史数据归档

3. **导出统计摘要** 📊
   - 所有会话的统计信息汇总表
   - 便于比较不同会话的结果
   - 适合科学研究报告

#### 🔄 数据导入功能
- **灵活格式**: 支持多种输入格式
  - 每行一个值：`0.25\n0.50\n0.75`
  - 逗号分隔：`0.25, 0.50, 0.75`
  - 百分比格式：`25%, 50%, 75%`
- **智能解析**: 自动处理空格、制表符等分隔符
- **数据验证**: 自动过滤无效值（超出0-1范围）

## 🛠 使用方法

### 1. 数据收集和保存
1. 在输入框中输入比例值（0-1之间）
2. 数据会自动保存到当前会话
3. 点击"保存当前数据"按钮将会话永久保存
4. 保存的会话会显示在历史记录中

### 2. Excel导出
1. **导出当前数据**：
   ```
   点击"导出当前数据"按钮
   → 下载包含当前所有数据的Excel文件
   → 文件包含原始数据和统计摘要两个工作表
   ```

2. **导出所有会话**：
   ```
   点击"导出所有会话"按钮
   → 下载包含所有保存会话的Excel文件
   → 每个会话一个工作表，外加总体摘要
   ```

3. **导出统计摘要**：
   ```
   点击"导出统计摘要"按钮
   → 下载包含各会话统计对比的Excel文件
   → 适合研究分析和报告生成
   ```

### 3. 数据导入
1. 点击"导入数据"按钮
2. 在弹出窗口中粘贴或输入数据
3. 支持的格式：
   - `0.25, 0.50, 0.75`
   - `25%, 50%, 75%`
   - 每行一个值
4. 点击"导入"确认

### 4. 会话管理
- **加载历史会话**: 点击会话旁的"加载"按钮
- **删除会话**: 点击"删除"按钮（不可恢复）
- **清除所有数据**: 删除所有保存的会话和当前数据

## 📋 Excel文件结构

### 当前数据导出
```
📁 比例分布数据_2024-01-15T10-30-00.xlsx
├── 📄 原始数据
│   ├── 序号 | 比例值 | 输入时间
│   └── 1    | 0.250  | 2024/1/15 10:30:00
└── 📄 统计摘要
    ├── 统计项    | 值
    ├── 数据点数量 | 50
    ├── 平均值    | 0.524000
    ├── 中位数    | 0.510000
    ├── 标准差    | 0.156789
    ├── 最小值    | 0.120000
    ├── 最大值    | 0.890000
    └── 范围      | 0.770000
```

### 所有会话导出
```
📁 所有会话数据_2024-01-15T10-30-00.xlsx
├── 📄 会话1（最新）
├── 📄 会话2
├── 📄 会话3
└── 📄 总体摘要
```

### 统计摘要导出
```
📁 会话统计摘要_2024-01-15T10-30-00.xlsx
└── 📄 会话统计摘要
    ├── 会话编号 | 时间 | 数据点数量 | 平均值 | 中位数 | 标准差 | 最小值 | 最大值 | 范围
    └── 1       | ... | 25        | 0.520 | 0.510 | 0.156 | 0.120 | 0.890 | 0.770
```

## 🔒 数据安全和隐私

- **本地存储**: 所有数据保存在浏览器本地，不会上传到服务器
- **隐私保护**: 您的实验数据完全私有，只有您能访问
- **数据备份**: 建议定期导出数据作为备份
- **跨设备**: 数据不会在不同设备间同步（基于浏览器本地存储）

## 🧪 科学研究应用

### 适用场景
- **科学展览项目**: 收集参与者的比例估计数据
- **统计学教学**: 演示抽样分布的中心极限定理
- **心理学实验**: 研究人们的比例感知能力
- **调查研究**: 收集和分析定量反馈

### 研究建议
1. **实验设计**: 在开始前规划好数据收集策略
2. **会话分组**: 为不同的实验条件创建不同的会话
3. **数据备份**: 及时导出重要的实验数据
4. **结果分析**: 使用Excel进行进一步的统计分析

## 🚀 技术特性

- **响应式设计**: 在各种设备上都有良好的用户体验
- **实时更新**: 数据输入后图表和统计信息实时更新
- **错误处理**: 完善的输入验证和错误提示
- **性能优化**: 大量数据时仍保持流畅的用户体验
- **可扩展性**: 支持无限数量的数据点和会话

## 🎨 用户界面亮点

- **直观的数据管理面板**: 清晰展示当前会话和历史记录
- **一键导出**: 简单的按钮点击即可下载Excel文件
- **统计可视化**: 实时显示重要的统计指标
- **友好的交互反馈**: 确认对话框和成功提示

---

**💡 提示**: 这些功能让您的比例分布实验室不仅是一个演示工具，更是一个完整的数据收集和分析平台！ 